# WebUI 使用指南

> **最後更新**：2025-12-22  
> **適用版本**：v1.0.0+

本指南詳細說明如何使用 Robot Command Console 的 Web 介面。

---

## 📑 目錄

- [介面概覽](#介面概覽)
- [首次登入](#首次登入)
- [主要功能區](#主要功能區)
- [機器人管理](#機器人管理)
- [指令執行](#指令執行)
- [批次操作](#批次操作)
- [監控與日誌](#監控與日誌)
- [系統設定](#系統設定)

---

## 介面概覽

### 整體佈局

```
┌─────────────────────────────────────────────────────────────┐
│  [Logo] Robot Command Console            [User] [Settings]  │
├──────────┬──────────────────────────────────────────────────┤
│          │                                                   │
│ Sidebar  │          Main Content Area                       │
│          │                                                   │
│ • 首頁    │  - 系統狀態                                       │
│ • 機器人  │  - 機器人列表                                     │
│ • 指令    │  - 指令執行與歷史                                 │
│ • 批次    │  - 批次操作                                       │
│ • 監控    │  - 即時監控                                       │
│ • 日誌    │  - 系統日誌                                       │
│ • 設定    │  - 系統設定                                       │
│          │                                                   │
├──────────┴──────────────────────────────────────────────────┤
│  Footer: Version 1.0.0 | Status: Connected | Uptime: 2h 15m │
└─────────────────────────────────────────────────────────────┘
```

---

### 頂部導航列

**左側**：
- **Logo**：點擊返回首頁
- **專案名稱**：Robot Command Console

**右側**：
- **通知圖示**：顯示系統通知與警告
- **使用者選單**：
  - 使用者名稱與角色
  - 個人設定
  - 登出

---

### 側邊欄選單

**主要導航**：
- 🏠 **首頁** - 系統概覽與狀態摘要
- 🤖 **機器人** - 機器人管理與監控
- ⚡ **指令中心** - 執行與管理指令
- 📦 **批次操作** - 批次指令管理
- 📊 **監控** - 即時指標與圖表
- 📝 **日誌** - 系統日誌查看
- ⚙️ **設定** - 系統與使用者設定

---

## 首次登入

### 訪問 WebUI

**Heavy 版本**：
- 啟動 Electron 應用後自動開啟

**Tiny 版本**：
- 啟動應用後自動在瀏覽器開啟

**手動訪問**：
```
http://localhost:8080
```

---

### 登入頁面

**欄位說明**：
- **使用者名稱**：您的帳號
- **密碼**：登入密碼
- **記住我**：勾選後保持登入狀態

**首次使用**：
1. 點擊「建立管理員帳號」
2. 填寫表單：
   - 使用者名稱
   - 電子郵件
   - 密碼（至少 8 個字元）
   - 確認密碼
3. 點擊「建立帳號」
4. 系統自動登入

---

### 忘記密碼

1. 點擊「忘記密碼？」
2. 輸入註冊的電子郵件
3. 檢查信箱收取重設連結
4. 點擊連結設定新密碼

---

## 主要功能區

### 首頁（Dashboard）

**系統狀態面板**：
- 🟢 **服務狀態**：
  - MCP Service: Running
  - Flask API: Running
  - Queue Service: Running
  - LLM Provider: Ready (Ollama)

**即時統計**：
- 📊 已連接機器人：3 / 5
- ⚡ 今日執行指令：247
- ✅ 成功率：98.3%
- ⏱️ 平均回應時間：125ms

**最近活動**：
- 顯示最近 10 條指令執行記錄
- 包含時間、機器人、動作、狀態

**快速操作**：
- ➕ 新增機器人
- ⚡ 執行指令
- 📦 建立批次
- 📊 查看完整報告

---

## 機器人管理

### 機器人列表

**顯示資訊**：

| 名稱 | 狀態 | IP 地址 | 電量 | 最後活動 | 操作 |
|------|------|---------|------|----------|------|
| robot-001 | 🟢 已連接 | 192.168.1.100 | 85% | 2 分鐘前 | 編輯/刪除 |
| robot-002 | 🟢 已連接 | 192.168.1.101 | 92% | 1 分鐘前 | 編輯/刪除 |
| robot-003 | 🔴 未連接 | 192.168.1.102 | N/A | 10 分鐘前 | 編輯/刪除 |

**功能按鈕**：
- 🔄 **刷新** - 更新機器人狀態
- ➕ **新增機器人** - 註冊新機器人
- 📥 **匯入** - 從檔案批次匯入
- 📤 **匯出** - 匯出機器人清單

---

### 新增機器人

**表單欄位**：

**基本資訊**：
- **機器人 ID** *（必填）：唯一識別碼（例如：robot-001）
- **名稱** *（必填）：顯示名稱
- **描述**（可選）：機器人說明

**網路設定**：
- **IP 地址** *（必填）：機器人 IP（例如：192.168.1.100）
- **埠號** *（必填）：通訊埠（預設：8080）
- **協定** *（必填）：下拉選單
  - HTTP (預設)
  - MQTT
  - WebSocket
  - Serial

**進階設定**（可選）：
- **連線逾時**：預設 30 秒
- **重試次數**：預設 3 次
- **心跳間隔**：預設 60 秒

**操作按鈕**：
- 🧪 **測試連線** - 驗證設定
- 💾 **儲存** - 儲存機器人
- ❌ **取消** - 放棄變更

---

### 機器人詳情頁

點擊機器人名稱進入詳情頁：

**資訊分頁**：
1. **概覽**：
   - 基本資訊（名稱、ID、IP）
   - 當前狀態（連線、電量、模式）
   - 最近活動

2. **指令歷史**：
   - 該機器人的所有指令記錄
   - 可篩選與搜尋

3. **效能指標**：
   - 指令執行統計
   - 成功率圖表
   - 回應時間分布

4. **設定**：
   - 編輯機器人資訊
   - 進階參數調整

---

### 批次操作機器人

**多選功能**：
1. 勾選多個機器人
2. 點擊「批次操作」按鈕
3. 選擇操作：
   - 🔄 重新連線
   - 📤 匯出選取項目
   - 🗑️ 批次刪除
   - 🏷️ 新增標籤

---

## 指令執行

### 指令中心

**介面佈局**：
```
┌─────────────────────────────────────────────────┐
│ 目標機器人：[robot-001 ▼]        [執行模式 ▼]  │
├─────────────────────────────────────────────────┤
│                                                 │
│ 指令輸入                                         │
│ ┌─────────────────────────────────────────────┐ │
│ │ go_forward                                  │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ 參數（可選）                                     │
│ ┌─────────────────────────────────────────────┐ │
│ │ {                                           │ │
│ │   "distance": 100,                          │ │
│ │   "speed": 0.5                              │ │
│ │ }                                           │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ [🧪 驗證] [💾 儲存為範本] [⚡ 執行]              │
└─────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────┐
│ 執行結果                                         │
│ ✅ 指令執行成功                                  │
│ • 指令 ID: cmd-12345                             │
│ • 執行時間: 1.5 秒                               │
│ • 狀態: success                                  │
└─────────────────────────────────────────────────┘
```

---

### 執行模式

**基本模式**（預設）：
- 輸入單一動作名稱
- 可選添加 JSON 參數
- 立即執行

**自然語言模式**（需啟用 LLM）：
- 輸入自然語言描述
- LLM 自動解析為指令序列
- 預覽後確認執行

**範本模式**：
- 從預設範本選擇
- 自動填入參數
- 快速執行常用指令

---

### 指令範本

**建立範本**：
1. 輸入指令與參數
2. 點擊「💾 儲存為範本」
3. 填寫範本資訊：
   - 名稱
   - 描述
   - 分類
4. 儲存

**使用範本**：
1. 點擊「從範本選擇」
2. 瀏覽或搜尋範本
3. 點擊範本自動填入
4. 修改參數（如需要）
5. 執行

**預設範本**：
- 🚶 基本移動（前/後/左/右）
- 🤸 姿勢控制（站/坐/躺）
- 👋 互動動作（揮手/點頭/搖頭）
- 🎯 導航（移動到座標）

---

### 指令歷史

**篩選選項**：
- **時間範圍**：今天 / 近 7 天 / 近 30 天 / 自訂
- **機器人**：全部 / 特定機器人
- **狀態**：全部 / 成功 / 失敗 / 執行中
- **動作類型**：全部 / 移動 / 姿勢 / 互動

**列表顯示**：

| 時間 | 機器人 | 動作 | 參數 | 狀態 | 執行時間 | 操作 |
|------|--------|------|------|------|----------|------|
| 10:05 | robot-001 | go_forward | {} | ✅ 成功 | 1.5s | 詳情/重試 |
| 10:03 | robot-002 | turn_left | {angle:90} | ✅ 成功 | 0.8s | 詳情/重試 |
| 10:01 | robot-001 | wave_hand | {} | ❌ 失敗 | - | 詳情/重試 |

**操作功能**：
- 🔍 **詳情** - 查看完整資訊與日誌
- 🔄 **重試** - 重新執行相同指令
- 📋 **複製** - 複製指令到輸入框
- 🗑️ **刪除** - 從歷史中移除

---

### 指令詳情

點擊「詳情」查看完整資訊：

**基本資訊**：
- 指令 ID
- 發送時間
- 完成時間
- 執行時長

**請求資料**：
```json
{
  "target": "robot-001",
  "action": "go_forward",
  "params": {"distance": 100},
  "timeout_ms": 30000,
  "trace_id": "trace-123"
}
```

**回應資料**：
```json
{
  "status": "success",
  "result": {
    "actual_distance": 98,
    "execution_time_ms": 1500
  },
  "timestamp": "2025-12-22T10:05:30Z"
}
```

**追蹤日誌**：
- 顯示完整執行過程
- 包含各階段時間戳
- 錯誤堆疊（如有）

---

## 批次操作

### 批次指令建立

**介面**：
```
┌─────────────────────────────────────────────────┐
│ 批次名稱：[示範序列                         ]   │
│ 描述：    [機器人演示動作序列               ]   │
├─────────────────────────────────────────────────┤
│ 指令列表                            [➕ 新增]   │
│                                                 │
│ 1. robot-001: stand                             │
│    [↑] [↓] [✏️] [🗑️]                             │
│                                                 │
│ 2. robot-001: wave_hand (delay: 1s)             │
│    [↑] [↓] [✏️] [🗑️]                             │
│                                                 │
│ 3. robot-002: go_forward (distance: 100)        │
│    [↑] [↓] [✏️] [🗑️]                             │
│                                                 │
├─────────────────────────────────────────────────┤
│ 執行選項                                         │
│ ☑ 錯誤時繼續執行                                 │
│ ☑ 自動重試失敗指令 (最多 3 次)                   │
│ ☐ 並行執行（針對不同機器人）                     │
│                                                 │
│ [💾 儲存批次] [▶️ 立即執行]                      │
└─────────────────────────────────────────────────┘
```

---

### 批次執行監控

**即時進度顯示**：
```
批次：示範序列
狀態：執行中

進度：3 / 10 (30%)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 成功：2
❌ 失敗：1
⏳ 執行中：1
⏸️ 待執行：6

當前指令：robot-002: turn_left
預估剩餘時間：45 秒

[⏸️ 暫停] [⏹️ 停止] [🔄 重試失敗]
```

---

### 批次歷史

**列表顯示**：

| 批次名稱 | 建立時間 | 指令數 | 成功 | 失敗 | 狀態 | 操作 |
|----------|----------|--------|------|------|------|------|
| 示範序列 | 12-22 10:00 | 10 | 9 | 1 | ✅ 完成 | 詳情/重跑 |
| 巡邏路線 A | 12-22 09:30 | 25 | 25 | 0 | ✅ 完成 | 詳情/重跑 |
| 測試動作 | 12-22 09:00 | 5 | 3 | 2 | ❌ 失敗 | 詳情/重跑 |

---

## 監控與日誌

### 即時監控

**系統指標**：
- 📊 CPU 使用率：25%
- 💾 記憶體使用：1.2GB / 8GB
- 🔌 網路流量：15 Mbps
- 📦 佇列深度：5 / 1000

**服務健康**：
- 🟢 Flask API: Healthy (回應時間: 15ms)
- 🟢 MCP Service: Healthy (回應時間: 20ms)
- 🟢 Queue Service: Healthy
- 🟡 LLM Provider: Warning (高延遲: 2500ms)

**圖表顯示**：
- 指令執行趨勢（最近 24 小時）
- 成功率變化
- 回應時間分布
- 機器人連線狀態歷史

---

### 日誌查看器

**篩選工具列**：
```
時間範圍：[最近 1 小時 ▼]
等級：[全部 ▼] INFO ☐ WARNING ☑ ERROR ☑
服務：[全部 ▼]
搜尋：[關鍵字                              ] [🔍]
```

**日誌列表**：
```
[2025-12-22 10:05:30] [ERROR] [MCP] Connection timeout
  trace_id: trace-123
  robot_id: robot-003
  error: TimeoutError after 30s
  [詳情]

[2025-12-22 10:05:15] [INFO] [Flask] Command executed
  trace_id: trace-122
  robot_id: robot-001
  action: go_forward
  duration: 1500ms
  [詳情]
```

**功能按鈕**：
- 🔄 **自動刷新** - 即時更新日誌
- 📥 **下載日誌** - 匯出為檔案
- 🗑️ **清除篩選** - 重設所有篩選

---

## 系統設定

### 使用者設定

**個人資訊**：
- 使用者名稱
- 電子郵件
- 角色（唯讀）

**偏好設定**：
- 語言：中文 / English
- 主題：淺色 / 深色 / 自動
- 時區：Asia/Taipei
- 日期格式：YYYY-MM-DD / DD/MM/YYYY

**通知設定**：
- ☑ 桌面通知
- ☑ 電子郵件通知
- ☐ 聲音提醒

---

### 系統設定

**服務配置**（需 admin 權限）：

**Flask API**：
- 埠號：5000
- Worker 數量：4
- Timeout：30 秒
- 日誌等級：INFO

**MCP Service**：
- 埠號：8000
- JWT 過期時間：1 小時
- 允許的來源（CORS）

**Queue Service**：
- 佇列大小：1000
- Worker 數量：5
- 輪詢間隔：0.1 秒

---

### LLM 設定

**提供商選擇**：
- ⚫ Ollama（本地）
  - 端點：http://localhost:11434
  - 模型：llama2
  - 狀態：🟢 已連接
  
- ⚪ OpenAI（雲端）
  - API 金鑰：sk-***（已遮蔽）
  - 模型：gpt-4
  - 狀態：⚪ 未啟用

**測試連線**：
```
[🧪 測試 Ollama]

結果：✅ 連線成功
回應時間：150ms
模型版本：llama2:latest
```

---

### 安全設定

**密碼原則**（admin）：
- 最小長度：8 個字元
- 需包含大小寫字母
- 需包含數字
- 需包含特殊符號

**Session 設定**：
- Session 逾時：30 分鐘
- 記住我期限：7 天
- 同時登入數限制：3 個裝置

**API Token**：
- Token 有效期：24 小時
- 自動輪替：啟用
- 輪替寬限期：5 分鐘

---

### 備份與還原

**自動備份**：
- 頻率：每日 02:00
- 保留數量：7 份
- 備份位置：data/backups/

**手動備份**：
```
[📥 立即備份]

備份內容：
☑ 資料庫
☑ 配置檔案
☐ 日誌檔案

[開始備份]
```

**還原備份**：
```
選擇備份：[db_20251222_020000.sqlite ▼]
         
⚠️ 警告：還原會覆蓋當前資料

[還原] [取消]
```

---

## 鍵盤快捷鍵

| 快捷鍵 | 功能 |
|--------|------|
| `Ctrl + K` | 開啟快速搜尋 |
| `Ctrl + N` | 新增機器人 |
| `Ctrl + E` | 執行指令 |
| `Ctrl + H` | 查看歷史 |
| `Ctrl + ,` | 開啟設定 |
| `Ctrl + /` | 顯示快捷鍵列表 |
| `Esc` | 關閉對話框 |

---

## 行動版優化

WebUI 支援響應式設計，在平板與手機上也能使用：

**自動調整**：
- 側邊欄自動收合
- 表格改為卡片式顯示
- 觸控友善的按鈕大小

**手勢支援**：
- 左右滑動切換頁面
- 下拉刷新
- 長按顯示選單

---

**回到索引**：[用戶指南索引](USER_GUIDE_INDEX.md)

**最後更新**：2025-12-22
