# 專案記憶改進計劃

> 建立日期：2025-12-17  
> 狀態：規劃中  
> 優先級：Medium-High

## 目標

建立更完善的專案記憶系統，包含標籤系統、優先級分類、搜尋工具和清理機制。

## 背景

當前專案記憶已成功精簡（2,633 行 → 327 行，88% 減少），但仍需要以下改進：

1. **標籤系統**：方便按主題/語言/模組快速查找
2. **優先級分類**：區分嚴重錯誤、最佳實踐、建議實踐
3. **搜尋工具**：快速搜尋相關經驗
4. **清理機制**：定期移除過時經驗

## 改進計劃

### Phase 1: 標籤系統 🏷️

**優先級**：High  
**工作量**：Medium（2-3 天）  
**預計完成**：2025-12（Q4）

#### 目標

為每條經驗教訓建立標籤系統，方便分類和搜尋。

#### 標籤架構

```yaml
tags:
  - language: [python, javascript, typescript, bash]
  - module: [flask, fastapi, textual, pytest, flake8]
  - type: [security, performance, testing, refactoring, bug-fix]
  - difficulty: [beginner, intermediate, advanced]
  - platform: [windows, macos, linux, cross-platform]
```

#### 實作步驟

1. **設計標籤架構**（0.5 天）
   - 定義標籤類別和值
   - 建立標籤規範文件
   - 確保標籤一致性

2. **建立標籤索引**（1 天）
   - 建立 `docs/memory/tags_index.json`
   - 格式：`{lesson_id: {tags: [...], file: "...", line: ...}}`
   - 包含所有現有經驗的標籤

3. **更新現有經驗**（1-1.5 天）
   - 為 Top 15 經驗加入標籤
   - 為專題文件中的經驗加入標籤
   - 格式：`<!-- tags: python, security, token -->`

4. **建立標籤查詢介面**（0.5 天）
   - 在 PROJECT_MEMORY.md 加入標籤索引
   - 建立按標籤瀏覽的章節

#### 範例

```markdown
### 3. 安全的 Token 生成⭐⭐⭐

<!-- tags: python, security, token, authentication, best-practice -->

**使用頻率**：所有認證相關功能
**相關文件**：[security_lessons.md](memory/security_lessons.md)
...
```

#### 交付成果

- [ ] 標籤架構文件
- [ ] `docs/memory/tags_index.json`
- [ ] 更新所有經驗加入標籤
- [ ] 標籤查詢介面

---

### Phase 2: 優先級分類 📊

**優先級**：High  
**工作量**：Small（1-2 天）  
**預計完成**：2025-12（Q4）

#### 目標

為每條經驗建立優先級分類，區分嚴重程度和重要性。

#### 優先級定義

| 級別 | 名稱 | 說明 | 範例 |
|------|------|------|------|
| **P0** | 嚴重錯誤 | 安全漏洞、資料丟失、系統崩潰 | 硬編碼 token、SQL 注入 |
| **P1** | 重要最佳實踐 | 效能問題、可維護性、常見錯誤 | 時間處理、型別提示 |
| **P2** | 建議實踐 | 代碼風格、慣例、優化 | Linting、命名規範 |
| **P3** | 參考資訊 | 歷史背景、備選方案、經驗分享 | 技術選型原因 |

#### 實作步驟

1. **定義優先級系統**（0.5 天）
   - 建立優先級規範
   - 定義每個級別的標準
   - 建立範例

2. **分類現有經驗**（1 天）
   - 為 Top 15 經驗分類
   - 為專題文件中的經驗分類
   - 格式：`**優先級**：P0 - 嚴重錯誤`

3. **建立優先級視圖**（0.5 天）
   - 在 PROJECT_MEMORY.md 加入優先級索引
   - 按優先級排序關鍵經驗
   - 突出顯示 P0 和 P1

#### 範例

```markdown
### 4. 安全的 Token 生成⭐⭐⭐

**優先級**：P0 - 嚴重錯誤（安全漏洞）
**使用頻率**：所有認證相關功能
**相關文件**：[security_lessons.md](memory/security_lessons.md)
...
```

#### 交付成果

- [ ] 優先級規範文件
- [ ] 更新所有經驗加入優先級
- [ ] 優先級索引視圖
- [ ] P0/P1 經驗突出顯示

---

### Phase 3: 搜尋工具 🔍

**優先級**：Medium  
**工作量**：Medium（2-3 天）  
**預計完成**：2026-01（Q1）

#### 目標

建立 CLI 工具，快速搜尋相關經驗教訓。

#### 功能需求

1. **關鍵字搜尋**
   - 搜尋經驗標題和內容
   - 支援正則表達式
   - 高亮顯示匹配結果

2. **標籤搜尋**
   - 按單一或多個標籤篩選
   - 支援標籤組合（AND/OR）
   - 列出符合條件的經驗

3. **優先級篩選**
   - 按優先級篩選（P0, P1, P2, P3）
   - 支援多個優先級組合
   - 預設顯示 P0 和 P1

4. **輸出格式**
   - 簡潔模式：僅標題和連結
   - 詳細模式：包含範例代碼
   - JSON 模式：程式化處理

#### 實作步驟

1. **設計搜尋工具**（0.5 天）
   - 定義 CLI 介面
   - 設計搜尋演算法
   - 規劃輸出格式

2. **實作搜尋引擎**（1.5 天）
   - 建立 `tools/search_lessons.py`
   - 實作關鍵字搜尋
   - 實作標籤和優先級篩選
   - 整合 tags_index.json

3. **實作輸出格式化**（0.5 天）
   - 簡潔模式
   - 詳細模式
   - JSON 模式

4. **測試與文件**（0.5 天）
   - 撰寫測試案例
   - 撰寫使用文件
   - 建立範例查詢

#### 使用範例

```bash
# 搜尋關鍵字
python3 tools/search_lessons.py "token"

# 搜尋標籤
python3 tools/search_lessons.py --tags security,python

# 搜尋優先級
python3 tools/search_lessons.py --priority P0,P1

# 組合搜尋
python3 tools/search_lessons.py "authentication" --tags security --priority P0

# 輸出 JSON
python3 tools/search_lessons.py "linting" --format json
```

#### 交付成果

- [ ] `tools/search_lessons.py` CLI 工具
- [ ] 搜尋引擎實作
- [ ] 測試案例
- [ ] 使用文件

---

### Phase 4: 清理機制 🧹

**優先級**：Medium  
**工作量**：Small（1-2 天）  
**預計完成**：2026-01（Q1）

#### 目標

建立定期審查和清理過時經驗的機制。

#### 清理策略

1. **版本追蹤**
   - 每條經驗標註生效版本
   - 記錄相關技術/框架版本
   - 標註棄用時間

2. **審查流程**
   - 每季度審查一次
   - 檢查技術是否仍然適用
   - 更新或歸檔過時經驗

3. **歸檔機制**
   - 過時經驗移至 `docs/archive/`
   - 保留歷史參考價值
   - 建立遷移記錄

#### 實作步驟

1. **設計版本追蹤**（0.5 天）
   - 定義版本格式
   - 建立版本追蹤欄位
   - 範例：`適用版本：Python 3.11+, Flask 2.3+`

2. **建立審查清單**（0.5 天）
   - 審查項目清單
   - 審查標準
   - 決策流程（保留/更新/歸檔）

3. **實作歸檔工具**（0.5 天）
   - 建立 `tools/archive_lesson.py`
   - 自動移動過時經驗
   - 更新索引和連結

4. **建立審查排程**（0.5 天）
   - 建立季度審查提醒
   - 建立審查報告模板
   - 文件化審查流程

#### 版本追蹤範例

```markdown
### 4. 安全的 Token 生成⭐⭐⭐

**優先級**：P0 - 嚴重錯誤
**適用版本**：Python 3.6+
**相關技術**：secrets (Python std), Flask, FastAPI
**最後審查**：2025-12-17
**狀態**：✅ 有效
```

#### 交付成果

- [ ] 版本追蹤欄位
- [ ] 審查清單與流程
- [ ] `tools/archive_lesson.py` 歸檔工具
- [ ] 季度審查排程

---

## 時間表

| Phase | 優先級 | 工作量 | 預計完成 | 狀態 |
|-------|--------|--------|---------|------|
| Phase 1: 標籤系統 | High | 2-3 天 | 2025-12 | 📋 計劃中 |
| Phase 2: 優先級分類 | High | 1-2 天 | 2025-12 | 📋 計劃中 |
| Phase 3: 搜尋工具 | Medium | 2-3 天 | 2026-01 | 📋 計劃中 |
| Phase 4: 清理機制 | Medium | 1-2 天 | 2026-01 | 📋 計劃中 |

**總工作量**：6-10 天  
**預計完成**：2026-01（Q1）

## 相關 Issues

- **Issue #186**: 實作專案記憶標籤系統和優先級分類（Phase 1 + 2）
- **Issue #187**: 建立經驗教訓搜尋工具（Phase 3）
- **Issue #188**: 建立過時經驗清理機制（Phase 4）

## 成功指標

- [ ] 所有經驗都有標籤和優先級
- [ ] 搜尋工具可在 3 秒內找到相關經驗
- [ ] 每季度完成一次審查
- [ ] 過時經驗移至歸檔，主記憶保持精簡

## 參考資料

- [PROJECT_MEMORY.md](../PROJECT_MEMORY.md) - 主要專案記憶
- [memory/](../memory/) - 專題經驗文件
- [GitHub Issues](https://github.com/ChengTingFung-2425/robot-command-console/issues)

---

**建立日期**：2025-12-17  
**最後更新**：2025-12-17  
**版本**：v1.0
